<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat Application | Login Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script>try { Typekit.load({ async: true }); } catch (e) { }</script>

  <style>
    .input-group-prepend span {
      width: 50px;
      border: 0 !important;
      background-color: white;
    }

    input {
      border: 0 !important;
      outline: 0 0 0 0 !important;
      box-shadow: 0 0 0 0 !important;
      height: 50px;

    }

    .input-group {
      border: 1px solid rgba(145, 129, 244, 1);
      border-radius: 5px;
      border-width: 1px;
    }
  </style>
</head>

<body>
  <section class="container">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-6 text-black">


          <div class="d-flex align-items-center h-custom-2 px-5 ms-xl-4 mt-5 pt-5 pt-xl-0 mt-xl-n5">
            <form style="width: 23rem;">

              <h3 class="fw-normal mb-3 pb-3 display-4 d-flex justify-content-center "
                style="letter-spacing: 2px; color:black;">LOGIN</h3>

              <div class="input-group form-group mb-4">
                <div class="input-group-prepend">
                  <span class="input-group-text">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-mail mt-2">
                      <rect width="20" height="16" x="2" y="4" rx="2" />
                      <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                    </svg>
                  </span>
                </div>
                <input type="email" id="email" class="form-control" placeholder="Email address" required
                  style="background-color: rgba(240, 237, 255, 0.8);" />
                <span class="text-danger" id="emailErr"></span>

              </div>

              <div class="input-group form-group mb-3">
                <div class="input-group-prepend">
                  <span class="input-group-text">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-lock-keyhole mt-2">
                      <circle cx="12" cy="16" r="1" />
                      <rect x="3" y="10" width="18" height="12" rx="2" />
                      <path d="M7 10V7a5 5 0 0 1 10 0v3" />
                    </svg>
                  </span>
                </div>
                <input type="password" id="password" class="form-control" placeholder="password" required
                  style="background-color: rgba(240, 237, 255, 0.8);" />
                <span class="text-danger" id="passwordErr"></span>

              </div>
              <p class="small mb-1 pb-lg-2"><a class="text-muted" href="#!">Forgot password?</a></p>

              <div class="form-check">
                <input class="form-check-input mt-3" style="border: 1px solid !important;" type="checkbox" value=""
                  id="remeber" checked />
                <label class="form-check-label mb-3 mt-2" for="remeber" style="font-size: larger;"> Remember me </label>
              </div>

              <div class="pt-1 mb-4 d-flex justify-content-center ">
                <button class="btn btn-lg btn-primary" type="button" id="authenticateUser">Login now</button>
              </div>

              <p>Don't have an account? <a href="SignUp.html" style="text-decoration: none;"
                  class="link-primary">Register here</a></p>
            </form>
          </div>
        </div>
        <div class="col-sm-6 px-0 d-none d-sm-block">
          <img src="assets/loginPage.png" alt="Login image" class="w-90 vh-100"
            style="object-fit: cover; object-position: left;">
        </div>
      </div>
    </div>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script src="validationForLogin.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js";
    const firebaseConfig = {
      apiKey: "AIzaSyDPTsWxwpb7aFRe9jE2urmRa5Ep9SxDF_k",
      authDomain: "airchat-65f4c.firebaseapp.com",
      databaseURL: "https://airchat-65f4c-default-rtdb.firebaseio.com/",
      projectId: "airchat-65f4c",
      storageBucket: "airchat-65f4c.appspot.com",
      messagingSenderId: "549237724062",
      appId: "1:549237724062:web:b691d727fc698b87f0fc8f",
      measurementId: "G-J3K53FWW9S"
    };
    const app = initializeApp(firebaseConfig);
    function authenticateFromFirebase() {
      console.log("Working")
     

      if (validateForLogin()) {
        const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      console.log(password)
      console.log(email)
       
        console.log("Conditional Statement")
       
        const auth = getAuth(app);
        signInWithEmailAndPassword(auth, email, password)
          .then((userCredentials) => {
            console.log("Sign-in successful");
            const user = userCredentials.user
            localStorage.setItem('loggedIn_user_id', user.uid)
            localStorage.setItem('loggedIn_user_email', user.email)
            setTimeout(() => { location.href = 'main.html'; }, 2000);

          }).catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
          })
      }
      else {
        console.log("error")
      }
    }
    $("#authenticateUser").on('click', function () {
      authenticateFromFirebase();
    })   
  </script>
</body>


</html>